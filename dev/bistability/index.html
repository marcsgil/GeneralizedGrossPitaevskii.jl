<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bistability · GeneralizedGrossPitaevskii.jl</title><meta name="title" content="Bistability · GeneralizedGrossPitaevskii.jl"/><meta property="og:title" content="Bistability · GeneralizedGrossPitaevskii.jl"/><meta property="twitter:title" content="Bistability · GeneralizedGrossPitaevskii.jl"/><meta name="description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><meta property="og:description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><meta property="twitter:description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GeneralizedGrossPitaevskii.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quick_start/">Quick-Start</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../free_propagation_damping/">Damped Free Propagation</a></li><li class="is-active"><a class="tocitem" href>Bistability</a><ul class="internal"><li><a class="tocitem" href="#The-analytical-solution"><span>The analytical solution</span></a></li><li><a class="tocitem" href="#The-numerical-solution"><span>The numerical solution</span></a></li></ul></li><li><a class="tocitem" href="../exciton_polariton/">Exciton Polariton</a></li><li><a class="tocitem" href="../truncated_wigner/">Truncated Wigner method</a></li></ul></li><li><span class="tocitem">Technical Documentation</span><ul><li><a class="tocitem" href="../general_overview/">General Overview</a></li><li><a class="tocitem" href="../spatial_grid/">Spatial Grid</a></li><li><a class="tocitem" href="../multicomponent_systems/">Multicomponent Systems</a></li><li><a class="tocitem" href="../stochastic_simulations/">Stochastic Simulations</a></li><li><a class="tocitem" href="../algorithm_implementation/">Algorithm Implementation</a></li><li><a class="tocitem" href="../gpu/">GPU Support</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Bistability</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bistability</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/marcsgil/GeneralizedGrossPitaevskii.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/marcsgil/GeneralizedGrossPitaevskii.jl/blob/main/examples/bistability.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Bistability-in-the-Polariton-Condensate"><a class="docs-heading-anchor" href="#Bistability-in-the-Polariton-Condensate">Bistability in the Polariton Condensate</a><a id="Bistability-in-the-Polariton-Condensate-1"></a><a class="docs-heading-anchor-permalink" href="#Bistability-in-the-Polariton-Condensate" title="Permalink"></a></h1><p>This example demonstrates the bistability phenomenon in a polariton condensate. The mean field equations describing this system may possess two stable solutions for certain parameters. They can be reached by varying the pump intensity, inducing a hysteresis loop. Here, we show the theoretical bistability curve and compare it with the results from a numerical simulation.</p><p>First we load the necessary packages:</p><pre><code class="language-julia hljs">using GeneralizedGrossPitaevskii, CairoMakie</code></pre><h2 id="The-analytical-solution"><a class="docs-heading-anchor" href="#The-analytical-solution">The analytical solution</a><a id="The-analytical-solution-1"></a><a class="docs-heading-anchor-permalink" href="#The-analytical-solution" title="Permalink"></a></h2><p>The mean field of the polariton condensate is described by a driven dissipative Gross-Pitaevskii equation of the form</p><p class="math-container">\[i \frac{\partial \psi}{\partial t} = F(x, t) + \left( - \delta - i \frac{\gamma}{2} - \frac{\hbar \nabla^2}{2m} + g |\psi|^2 \right)\psi\]</p><p>In the above, ψ represents the wave function of the polariton condensate, which is a complex-valued function of space and time, F(x, t) is an external pump, which is a monochromatic term detuned from the cavity resonance by a frequency δ, γ is the decay rate of the polaritons, ħ is the reduced Planck constant, m is the effective mass of the polaritons, and g is the strength of the nonlinear interaction.</p><p>Here we define the numerical values of some of the parameters</p><pre><code class="language-julia hljs">ħ = 0.654 # (meV*ps)
m = 1 / 3
g = 0.01
δ = 0.3
γ = 0.1;</code></pre><p>It can be shown that, in a steady and homogeneous state, the intensity I = |F|^2 necessary to support the fluid at a given density n is given by the following function:</p><pre><code class="language-julia hljs">function bistability_curve(n, δ, g, γ)
    n * (γ^2 / 4 + (g * n - δ)^2)
end;</code></pre><p>Here, this theoretical curve is displayed:</p><pre><code class="language-julia hljs">ns_theo = LinRange(0, 41, 512)
Is_theo = bistability_curve.(ns_theo, δ, g, γ)

with_theme(theme_latexfonts()) do
    fig = Figure(fontsize=16)
    ax = Axis(fig[1, 1]; xlabel=&quot;I&quot;, ylabel=&quot;n&quot;)
    lines!(ax, Is_theo, ns_theo, color=:blue, linewidth=4, label=&quot;Theoretical&quot;)
    fig
end</code></pre><img src="d5e270d8.png" alt="Example block output"/><p>It can be seen that, for certain values of the parameters, the system exhibits bistability, with two stable solutions for the same pump intensity.</p><h2 id="The-numerical-solution"><a class="docs-heading-anchor" href="#The-numerical-solution">The numerical solution</a><a id="The-numerical-solution-1"></a><a class="docs-heading-anchor-permalink" href="#The-numerical-solution" title="Permalink"></a></h2><p>Now, we wish to reproduce the bistability curve using a numerical simulation. This is achieved by slowly varying the pump intensity and observing the resulting steady-state densities. The first step is to specify the equations governing the system.</p><p>Here is the dispersion term, which models the Laplacian in Fourier space. As these are constants, we also include the detuning and decay terms.</p><pre><code class="language-julia hljs">function dispersion(ks, param)
    param.ħ * sum(abs2, ks) / 2param.m - param.δ - im * param.γ / 2
end;</code></pre><p>Next, we define the nonlinear term.</p><pre><code class="language-julia hljs">nonlinearity(ψ, param) = param.g * abs2(ψ[1]);</code></pre><p>Finally, we define the pump profile. Here, we define the time-dependent pump intensity, which is a parabola that has zeros at t=0 and <code>t=2tmax</code>, and a maximum <code>Imax</code> at <code>t=tmax</code>.</p><pre><code class="language-julia hljs">function I(t, tmax, Imax)
    val = -Imax * t * (t - tmax) * 4 / tmax^2
    val &lt; 0 ? zero(val) : val
end;</code></pre><p>We also define the complete pump profile, which includes both the spatial and temporal components. The spatial profile is a Gaussian centered in the middle of the system.</p><pre><code class="language-julia hljs">function pump(x, param, t)
    exp(-sum(abs2, x .- param.L / 2) / param.width^2) * √I(t, param.tmax, param.Imax)
end;</code></pre><p>We now choose the numerical values of the pump constants:</p><pre><code class="language-julia hljs">tmax = 4000
Imax = maximum(Is_theo)
width = 50;</code></pre><p>We now define the spatial grid used in the simulation:</p><pre><code class="language-julia hljs">L = 256
lengths = (L,)
N = 128</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">128</code></pre><p>The initial condition is a vector of zeros, corresponding to an initially empty cavity.</p><pre><code class="language-julia hljs">u0 = (zeros(ComplexF64, N),);</code></pre><p>Now the time parameters are defined:</p><pre><code class="language-julia hljs">dt = 0.1
tspan = (0, tmax);</code></pre><p>Also, we define the number of saves and the algorithm to use.</p><pre><code class="language-julia hljs">nsaves = 512
alg = StrangSplitting();</code></pre><p>Finally, we collect all the necessary parameters in a named tuple</p><pre><code class="language-julia hljs">param = (; tmax, Imax, width, δ, ħ, m, γ, g, L);</code></pre><p>Now, we define the problem and obtain the solution:</p><pre><code class="language-julia hljs">prob = GrossPitaevskiiProblem(u0, lengths; dispersion, nonlinearity, pump, param)
ts, sol = solve(prob, alg, tspan; dt, nsaves, show_progress=false);</code></pre><p>In the following plot, we can see the evolution of the density over time.</p><pre><code class="language-julia hljs">with_theme(theme_latexfonts()) do
    xs = (0:N-1) * (L / N)
    fig = Figure(fontsize=24)
    ax = Axis(fig[1, 1]; xlabel=L&quot;x&quot;, ylabel=L&quot;t&quot;)
    heatmap!(ax, xs, ts, abs2.(sol[1]); colormap=:viridis, colorrange=(0, 40))
    fig
end</code></pre><img src="3556d98b.png" alt="Example block output"/><p>As expected, the density slowly rises as we increase the pump intensity. When the tip of the lower branch is reached, the system jumps suddenly to the upper branch. A backwards behavior is observed when decreasing the pump intensity, where the system can jump back to the lower branch.</p><p>Finally, we can compare the simulation results with the theoretical predictions. We do this by plotting the density as a function of the pump intensity.</p><p>The pump intensity is given by the function I(t, tmax, Imax) calculated at the saved time points.</p><pre><code class="language-julia hljs">Is = I.(ts, tmax, Imax);</code></pre><p>On the other hand, the density is obtained from the solution evaluated at the center of the cavity, which is where the pump attains its maximum value.</p><pre><code class="language-julia hljs">ns = abs2.(sol[1][N ÷ 2, :]);</code></pre><p>Now, we plot the results, comparing with the theory discussed earlier.</p><pre><code class="language-julia hljs">with_theme(theme_latexfonts()) do
    fig = Figure(fontsize=24)
    ax = Axis(fig[1, 1]; xlabel=&quot;I&quot;, ylabel=&quot;n&quot;)
    lines!(Is, ns; label=&quot;Simulation&quot;, color=:red, linewidth=5)
    lines!(ax, Is_theo, ns_theo, color=:blue, linewidth=5, label=&quot;Theory&quot;, linestyle=:dash)
    axislegend(ax, position=:rb)
    fig
end</code></pre><img src="1f4fdfcf.png" alt="Example block output"/><p>We can see that the simulation closely matches the theoretical predictions,</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../free_propagation_damping/">« Damped Free Propagation</a><a class="docs-footer-nextpage" href="../exciton_polariton/">Exciton Polariton »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 30 September 2025 13:26">Tuesday 30 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
