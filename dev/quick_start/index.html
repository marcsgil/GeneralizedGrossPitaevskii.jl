<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quick-Start · GeneralizedGrossPitaevskii.jl</title><meta name="title" content="Quick-Start · GeneralizedGrossPitaevskii.jl"/><meta property="og:title" content="Quick-Start · GeneralizedGrossPitaevskii.jl"/><meta property="twitter:title" content="Quick-Start · GeneralizedGrossPitaevskii.jl"/><meta name="description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><meta property="og:description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><meta property="twitter:description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GeneralizedGrossPitaevskii.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Quick-Start</a><ul class="internal"><li><a class="tocitem" href="#Free-Propagation"><span>Free Propagation</span></a></li><li><a class="tocitem" href="#Gross-Pitaevskii-Equation"><span>Gross-Pitaevskii Equation</span></a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../free_propagation_damping/">Damped Free Propagation</a></li><li><a class="tocitem" href="../bistability/">Bistability</a></li><li><a class="tocitem" href="../exciton_polariton/">Exciton Polariton</a></li><li><a class="tocitem" href="../truncated_wigner/">Truncated Wigner method</a></li></ul></li><li><span class="tocitem">Technical Documentation</span><ul><li><a class="tocitem" href="../general_overview/">General Overview</a></li><li><a class="tocitem" href="../spatial_grid/">Spatial Grid</a></li><li><a class="tocitem" href="../multicomponent_systems/">Multicomponent Systems</a></li><li><a class="tocitem" href="../stochastic_simulations/">Stochastic Simulations</a></li><li><a class="tocitem" href="../algorithm_implementation/">Algorithm Implementation</a></li><li><a class="tocitem" href="../gpu/">GPU Support</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Quick-Start</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quick-Start</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/marcsgil/GeneralizedGrossPitaevskii.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/marcsgil/GeneralizedGrossPitaevskii.jl/blob/main/examples/quick_start.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h1><p>In this quick start example, we will demonstrate how to set up a simple Gross-Pitaevskii problem and solve it using the GeneralizedGrossPitaevskii package. As a first example, we will simulate free propagation of a wavefunction in a 2D grid. Latter, we will add a nonlinear term in order to have a proper Gross-Pitaevskii equation.</p><h2 id="Free-Propagation"><a class="docs-heading-anchor" href="#Free-Propagation">Free Propagation</a><a id="Free-Propagation-1"></a><a class="docs-heading-anchor-permalink" href="#Free-Propagation" title="Permalink"></a></h2><p>We first load a few necessary packages.</p><pre><code class="language-julia hljs">using GeneralizedGrossPitaevskii, CairoMakie, StructuredLight</code></pre><p>CairoMakie and StructuredLight are used for visualization.</p><p>The first step is to define the parameters of the grid of our simulation. We will simulate a 2D system with a grid with N x N points with size of L x L.</p><pre><code class="language-julia hljs">N = 128
L = 8;</code></pre><p>Now we define a lengths parameter:</p><pre><code class="language-julia hljs">lengths = (L, L);</code></pre><p>This is a tuple that defines the physical dimensions of the simulation domain. Each element corresponds to the size of the grid in each dimension. As we will be simulating a 2D system, and the grid is square, both elements are equal.</p><p>Next, we define the initial condition of the wavefunction. This is the step size of the grid.</p><pre><code class="language-julia hljs">ΔL = L / N;</code></pre><p>This is used to create a range of points in the grid.</p><pre><code class="language-julia hljs">rs = StepRangeLen(0, ΔL, N);</code></pre><p>Observe that this package always assume that the grid starts is of the from 0, ΔL, 2ΔL, ..., (N-1)ΔL. This is easily created with the <code>StepRangeLen</code> function.</p><p>We can use this grid to create an initial condition for the wavefunction:</p><pre><code class="language-julia hljs">initial_condition = [exp(-(x - L / 2)^2 - (y - L / 2)^2) for x in rs, y in rs];</code></pre><p>This creates a 2D array representing a Gaussian wavefunction centered at the middle of the grid.</p><p>Let us visualize the initial condition:</p><pre><code class="language-julia hljs">visualize(abs2.(initial_condition))</code></pre><img width=128 height=128 style='object-fit: contain; height: auto;' src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAlwSFlzAAAdhwAAHYcBj+XxZQAAFZ9JREFUeAHtwQ9vXdWdqOF37bOOj2PHIQGXBEJC6ZROiYSQbqfS/Xb3613d6YxUIcG0dEohTXCowSGO4+PzZ6+rtd9IM7s9GCcklM76PU+G/1MIITQpE0JoViaE0KxMCKFZmRBCszIhhGZlQgjNyoQQmpUJITQrE0JoViaE0KxMCKFZmRBCszIhhGZlQgjNyoQQmpUJITQrE0JoViaE0KxMCKFZmRBCszIhhGZlQgjNyoQQmpUJITQrE0JoViaE0KxMCKFZmRBCszIhhGZlQgjNyoQQmpUJITQrE0JoViaE0KxMCKFZmRBCszIhhGZlQgjNyoQQmpUJITQrE0JoViaE0KxMCKFZmRBCszIhhGZlQgjNyoQQmpUJITQrE0JoViaE0KxMCKFZmRBCszIhhGZlQgjNyoQQmpUJITQrE0JoViaE0KxMCKFZmRBCszIhhGZlQgjNyoQQmpUJjUg8n0L4nysTQmhWJvyDS7xciYsphH88mRBCszLhH0Tixy2xWSH8eGVCCM3KhB+pxLNJ/H0UzpcYK4Qfj0wIoVmZ8CORuJjE+RI/jIISmxU2S4wVwt9PJoTQrEz4O0lcTGKzxFhis8SLURhLqDBWUGKssFlirBB+OJkQQrMy4QeWOF9iLDGWGEuMJcYSY4mLKYwVxgpKqKCECucrbJZQIbx8mRBCszLhB5LYLLFZQomxhBJKKKHEWEKJ51NQYaygggoqnK+gxFhhLKFCeHkyIYRmZcJLkjhfYiyhxFhCCXUooYQSSiihhBJKXExBBRVUUEEFFVRQjwpjCRVUUEKFscRYIbw4mRBCszLhBUucLzGWUEIJJdShhDqUUIc61KGEOpRQ4mIKKqhHBfWoRz0qKKGCelTYrKCECpslVAjfXyaE0KxMeEES50soMZZQhxLqUIc61KEOTVCHJqhDHUqoYyyhwliPCupRj9aoR2vUox71KKEeFdRzvsJmCRXC88uEEJqVCS9ZQgkllFBCHepQhyaoQxlN0ARlNEETNEEd6lBis4J61KM1WqM1WqE1WqMV6tEaJdQzVlBhs0J48TIhhGZlwveU2CyhhBJKKKEOTVCHJiijjDLKaIqmKKOMMpqgDnVs1qMerdEKrdAKLdESrdAErVBCa5QY67mYwlhChfDsMiGEZmXCc0psllBCCSWU0AR1aIIyyiijLTRFW2gLzdAUbaEpymiCOjbr0Rqt0BIt0BKdoQVaoCVaoA6t0IqxhNZcTGEsoUK4uEwIoVmZ8IwSmyU2SyihCerQBGU0RVtoC83QDG2jbbSNttEMzdAUZdShhArq0Qot0Rk6Q3M0R3M0R2doghYocTFrxgpjCRXGEiqE75YJITQrE76nxFhCCSXUoQ5N0BRN0RaaoW10CV1Cu2gH7aIddAltM0hbDKZoghIqaI2WqCzQHJ2iJ+gEPUEn6BRNUIcSSiixWUE9SowVlFAhPLtMCKFZmXBBifMllFCHOjRBE5TRFG2hbXQJ7aDL6DLaQ3toj8F0m8FltIu20QxllFBBK3SG5lsMTrYYPL7CYDlHx+gYzdBjNEEdSmxWuJiescJmCRXCt8uEEJqVCc8pMZZQQgl1qEMZTdEW2kY7aBftoSvoFXSNwdYOg2voKnoF7aFdtI2mqEM9WqI5OkHH6Bv0cJvB0TaDxS6aoSmaoA4lNiuMFVRQQYmxghIqhIvLhBCalQnfIXG+xFhCHerQBGW0hWboEtpFV9BVdA29xuDahMFP0D7aR6+iq+gK2kFbqEM9WqAn6BF6iL5Gh+gQ/WWHwdEMTdEEJcYKKqiggnpUUEEFFZRQYbOECuFvZUIIzcqEZ5RQQgkl1KEOTVBGGW2hbbSD9tBV9BqDtM/gOrqB3kBvoBvodbSPrqHLaBt1qEdz9BgdoUP0JTpAX6AdNJswePA6g9IxVlCPetSjNepRQQUVVDhfIXy3TAihWZnwLRLPJqGEOtShjLbQDF1Cl9EVdI1B2mfwBnoL3UK30G10C91EN9A+g26vp7rEKdWENdWaCdUpl6j6447BITpA99BddAXtoC3UoS/2GZQerdEardEarVGP1qhDPUqocDEJFcJ/yYQQmpUJF5QYSyihDnWoQxllNEUzdAldRq+g1xhcR2+hn6KfoX9CP0c/Y9Dd7qlu8meqGzygusYR1S4nVBNWVGsy1Qm7VEd716gO9q5T3XvnLar+847BPtpD22jCWI8OXkNLtEQLtERLtEJr1KMOFVQYKyihQvh2mRBCszLhGSXGEkoooQ5NUEZbaBvtoj10jcG1CYMb6Bb6Gfoleg+9x+DNvXtU7/IHqp/yKdVN7lHtc0i1x2OqzJJqxZTqmMtUh+xT3eMm1Z94h+qT2z+nun/tJoMdNGVsjRbobMLg6Bo6Q2dogRZoiVaoQwkllFBBCRXCd8uEEJqVCX8lcTEJJZRQhyZogqZoC22jHbTHYGuHwU/QG+gW+if0HvqAwT/P/oPqfT6kusNHVO/yCdXbfE51nQdUV3hENWVJtWRK9YgrVA+4TvUZt6k+4V2qn/Al1Yd771P97oNfMrJEc/QEPUEnOwwWe+gJOkVztEBLNEFr1KOEEiqcL6FCgEwIoVmZ8B0SY4mxhBLqUIcymqIZ2ka7aI/BNbSP3kC30c/Rewz+efYfVP/Cb6h+xb9RfcBvqe7wMdWNkwMG99FDtERTBjeuHlD94s3fU727e4PqTe5TXeUh1YwzBjMGv3vvlwyeoGP0CH2DvkEP9tBjdIJm6AxltEQdSigxllBBCRXC38qEEJqVCReUGEsooYQ6NEETlNEUbaMdBtNtBlfRPrqBbqGfMXhz7x7V+3xI9Sv+jep/83+pfs1vqPJHKwa/R3fR12iBttCr6BaDG784oNq/c0h1iVP+uzNmVMd7e1T3f3aTwSE6RIfoK/T1NoPlDtpGU5TRBE1QhxJKKKGCEiqEb5cJITQrE16QhBLq0ARltIVm6BKDy+gV9Cp6Hd1k0N3uqd7lD1R3+IjqA35L9Wt+Q5X/dcXg39FH6DP0FTpDM/Qaehs9YJBPVlS//vVvqE65RPWQq1R/4XWqg9tvUPX3Ogb30KvoFXQZHV1CM7SFMpqgDiWUCN9fJoTQrEx4RgkllFBCHerQBGU0RTO0zWAX7aGraB/dYHCTP1P9lE+p3uUTqjt8TJU/WjH4d/T/0IfoUwblkMEZmqG0j+6jx4zk3RXVnTsfU93nTarPeJvqj7xDdffGbQb76CraQ7voaBvN0BRlNEEd6lBCCSWUUCF8t0wIoVmZ8FTi+SSUUEIJdWiCMpoySFsMttEuuoKuoX0GN3hAdZN7VG/zOdWNkwMGv0cfoQ/RbxncXTD4Ep2hGXr9kMGtR4xdRtcZ3Hj7gOrt3c+pbnKP6gYPqO7u32ZwDV1Bu2gbpS0GZYoymqAOJZRQQonnk1ChZZkQQrMy4TklxhJKqEMd6tAEZQZTNEPbaAddZtDt9VTXOKLa55DqOg8Y3Ed30WfoUwZ3Fww+QQ/QHG2jb3hqweDWp+hNdBfdZ3D93QdU+xxSXeOIqtvrqfrLHYMdtI1maIoWGU1QhzrUoYQSY4nw7DIhhGZlwkuWUIc61DGYoIymaAttM7jEKdUuJ1R7PKa6wiMGD9HX6CsG5ZDBl+gBeoDmaJuxV9BbhwzSV+hr9JDBFR5R7fGYapcTqkucUp1s7zLYQlOU0YSnOtShDiXCy5MJITQrE16SxPkSg4QS6lCHOgYT1lQTVlSZJdWUJYMlWqAzBmfoDM3RHM0Zm6MzdIa2z9ACLRlMWVJlllQTVlQT1gw61KEOJZR4KnG+RHjxMiGEZmXCS1I4X2FQUEE96lHPYM2Eak2mWjGlWjJlMEVbaMZghmZoG20zto220QzNeGqGttCUwZIp1Yop1ZpMtWbCoEc96lFBhacK5yuEFy8TQmhWJrxkBfWoRz2DNVqhJVqgOYNTLlGdsEt1zGWqR1yhunH1gMGr6DUGaZ/B64cMvmFsjrbRdfQ6SvvoNfQqusrgEVeojrlMdcIu1SmXGMzRAi3RCq15qkc96lEhvDyZEEKzMuE5FcYKKqhHPerRGq0YLNEZmqMn6DGD/rijOtq7RnXIPtUDrlP94s3fM7iF3kb3Gdx6hBYMXkFnaIZeR7e20DvobXQLvcngAdepDtmnOuIaVX/cMXiMnqA5OkNLnlqhNepRj3pUUGGsEJ5dJoTQrEx4qqDEsymooIIK6tEardCSQVkwmG8xOEGP0BE6ZHCwd53qHjepPuM21bu7N6hu/OKAwQP0mJFbnzJ465DBGZqhtI/eQe+jO+gXDA52b1B9xm2qe9ykOuA6g0N0hB6hEzRHZYGWaIXWqEcFFVRQ4fkUAmRCCM3KhGdUUEEFFdSjHq3RCi3RGZozONlicIweokN0wODeO29R/Yl3qD7hXao3uU+1f+eQKp+sGLmM3mSQvmKwfYZm6DX0NrqD/heD1Z1M9RHvUX3Cu1R/4h2qe7zF4AAdoofoGJ3w1BydoSVaoTXqUY8KKqigQri4TAihWZnwghRUUI/WaIUW6AydMnh8hcE36Gv0JbrHoP+8o/rk9s+pfsKXVFd5SHWJU6pf//o3VHl3xeA6uou+Rgu0hV5Ft9AvGKzuZKp/5V+ofssHVB9xh+oTfk7Vf94xuIe+RF+jb9BjnjpFZ2iBVmiNelRQIXx/mRBCszLhggpKqKCCCurRGq3RCi3RHD1hsJwzeLjN4BAdoLton8H9azepPtx7n2rGGf/dKZeo7tz5mOrG2wcM7qOHaImm6Cp6k8HB7g2qj3iP6rd8QPVv/IrqQ96nun98k8Ef0V10gA7RQ7ScoydojpZohdZojXpUUEGFsUL4bpkQQrMy4TsUlFBBCRVUUI96tEJLdIbm6AQdMzjaZnCIvkBX0B7aYfC7D37JYMbgjBnVQ65S3edNqrd3P6e6/u4Dqis8opqypFoypXrEFaoHXKf6jNtUn/Au1UfcofqQ96l+d/ZLBh+jP6DP0RfoEB3x1DE6QXN0hpZohXrUo4IKY4WxQvh2mRBCszLhrxSUOF9BBRXUozVaoyVaoDl6go4ZLHYZ/GWHwQ7aQdtoysjv3vsl1fHeHtVfeJ3qM96musk9qn0OqfZ4TJVZUq2YUh1zmeqQfap73KT6E+9QfcLPqe4f32TwMfoY/Se6i75Af0GLJ+gYPUFztEBLtEZr1KOCCipcTCH8l0wIoVmZ8IwKSqigggrq0Rqt0ALN0QmaoRmDoxmD2YTBFpowtkRPGNz/2U2qg9tvUP2Rd6hu8IDqGkdUu5xQTVhRrclUJ+xSHXGN6oDrVPd4i6r/vGPwR/QH9J/oj+guOkBHa3SEjtEJmqMFWqE16lFBBRXGCuHiMiGEZmXCBRWUUGGsRwn1aIUmaInO0Cl6jKZoyuDB6ww6xtZojo7RIYP+Xkd198Ztqrv7t6m6vZ7qEqdUE9ZUayZUp1yi6o87BofoAN1Dd9Hn6C66i/6MHvDUV+gb9BidojO0RCu0Qj3qUY8KKowVwnfLhBCalQnfoqDExRRUUI96tEILNEETNEETNGFQOgZf7DPo0QI9QY/QIbqH9tE1Bv3ljupke5dBh3o0R4/RETpEX6ID9AX6Ah2gB6gcoiP0CD1Gp+gMLdAK9ahHBRWeTSH8rUwIoVmZ8IwK5+tRQmuUUIcWqEMd6lBipPQMDl5jcDZh8AR9gw7Rq+gquoJ20BbqUI8W6Al6hB6ir9EhOkR/QUdr9BU6Qg/RMXqC5miBVmiF1qhHPSqooIIK4eIyIYRmZcJ3KCixWUEJFdSjhNZohRJKKKHEWEFrtGRwdI3ByQ6Db9BX6BW0h3bRNpqiDvVoieboBB2jb9BDdIQWT9AR+gY9QsfoBJ2iM7RAK7RGPepRYaxwvkL4dpkQQrMy4TkVlFBhrKAeJbRiLLFZQT1aoyU6Y7DYY/Bgj8HX2wwuo120jWYoo4QKWqEzNEcn6DFaztExOkbH6DF6jJ6gUzRHC7REK9SjHhVUUGGsEJ5dJoTQrEy4oIISmxXGei4msVlBPVqjBTpDT9BjBssdBkeXGBxtM0hbDKZoghIqaI2WqCzQHJ2iJ+gEPUEn6BSdojk6Qwu0RCu0RmvUox4VVDhfIXy3TAihWZnwPRWUUGGsoB4lNiuooIJ6tEZLtECn6ARtoxmaMShTBouMOpRQQT1aoSU6Q2dojuZojuboDJ2hBVqgJVqhNepRjwoqqDBWCM8vE0JoViY8o4ISYwUlxgpjay6moDVaoyVaoDmaoSnaQlOU0QR1bNajNVqhJVqgJTpDC7RAS7RAK7RCK7RGPVqjggqbFTYrhIvLhBCalQnPqaDEWOFi1qgwVlCPetSjFVqiBTpDGWWU0QR1qGOzHvVojVZohVZoiZZohVZohVZojXq0Rj0qqKCCCipsVgjPLhNCaFYmfE8FJcYKF9MzVlBBBa3RGq3QEmU0QRM0QR3qUGKzgnrUozVaozVaoTVaoxXq0Rr1qEc9KqigggoqbFYIzy8TQmhWJrxkhc0KSowVVFBBHepRhyZoiSaoQx1KqGMsocJYjwrqUY/WqEdr1KMe9ahHPSqoR4Wxggrh5cmEEJqVCS9IQYnNCufrUUIFFdSjDiW0Rh3qUEIdSihxMQUV1KOCetSjHhXUo4J6VFBBBRXGCucrhO8vE0JoVia8YAUlNisoocJmBRWUUEEJ9SihhBJKKKHExRRUUEEFFVRQQQX1qKDCWEGFscL5CuHFyYQQmpUJL0lhLDFWUEIFFZQYK6ighBJKKDGWUOL5FFQYK6igggoqjBVU2KywWSG8PJkQQrMy4QdSUGKsMJZQ4XwFJcYSY4mxxMUUxgpjhbHCWGGsMFY4XyG8fJkQQrMy4QdWUGKzwvkKSqighApjiRejsFlhrLBZ4WIK4YeTCSE0KxP+Tgpjic0KYwkVxgpKjBVejsL5ChdTCH8/mRBCszLhR6IwltissFlChR9W4dkUwo9HJoTQrEz4kSqMJc5X+HEqhB+vTAihWZnwD6KwWeLHoRD+8WRCCM3KhH9whYtJPJ9C+J8rE0JoViY0ohDCX8uEEJqVCSE0KxNCaFYmhNCsTAihWZkQQrMyIYRmZUIIzcqEEJqVCSE0KxNCaFYmhNCsTAihWZkQQrMyIYRmZUIIzcqEEJqVCSE0KxNCaFYmhNCsTAihWZkQQrMyIYRmZUIIzcqEEJqVCSE0KxNCaFYmhNCsTAihWZkQQrMyIYRmZUIIzcqEEJqVCSE0KxNCaFYmhNCsTAihWZkQQrMyIYRmZUIIzcqEEJqVCSE0KxNCaFYmhNCsTAihWZkQQrMyIYRmZUIIzcqEEJqVCSE0KxNCaFYmhNCsTAihWZkQQrMyIYRmZUIIzcqEEJqVCSE0KxNCaFYmhNCsTAihWZkQQrMyIYRmZUIIzcqEEJr1/wF7zrMQiHe9AwAAAABJRU5ErkJggg=="/><p>As this package is able to handle systems with multiple wavefunctions, we need to wrap the initial condition in a tuple with one element:</p><pre><code class="language-julia hljs">u0 = (initial_condition,);</code></pre><p>This indicates that we have one wavefunction in our simulation.</p><p>Next, we need to specify the equation that our system obeys. As this is a free propagation problem, we the wavefunction satisfies the Schrödinger equation i ∂u(r, t)/∂t = -∇²u / 2 In Fourier space, this corresponds to a dispersion relation D(k) = |k|² / 2, which we now define:</p><pre><code class="language-julia hljs">dispersion(ks, param) = sum(abs2, ks) / 2;</code></pre><p>The extra argument <code>param</code> is a placeholder for additional parameters, such as mass, that may be needed in more complex problems, but is not used here.</p><p>Now we can create the problem instance:</p><pre><code class="language-julia hljs">prob = GrossPitaevskiiProblem(u0, lengths; dispersion);</code></pre><p>This encapsulates all the necessary components to define the Gross-Pitaevskii equation.</p><p>Now that we have defined the problem, we can solve it. We just need to specify some additional parameters: This is the algorithm we will use to solve the problem:</p><pre><code class="language-julia hljs">alg = StrangSplitting();</code></pre><p>Right now, this is the only algorithm implemented in this package, so there isn&#39;t much choice.</p><p>This algorithm uses a fixed time step, which we can define:</p><pre><code class="language-julia hljs">dt = 0.01;</code></pre><p>Next, we define the time span of the simulation:</p><pre><code class="language-julia hljs">tspan = (0, 1);</code></pre><p>This indicates that we want to simulate the system from time t=0 to t=1</p><p>Now, we indicate how many times we want to save the solution during the simulation:</p><pre><code class="language-julia hljs">nsaves = 64;</code></pre><p>Finally, we can solve the problem:</p><pre><code class="language-julia hljs">ts, sol = solve(prob, alg, tspan; nsaves, dt);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr32">Progress:   2%|▋                                        |  ETA: 0:00:09</span><span class="sgr32">Progress: 100%|█████████████████████████████████████████| Time: 0:00:00</span></code></pre><p>The <code>solve</code> function returns two values: the time points <code>ts</code> on which the solution was saved and the solution <code>sol</code>. <code>sol</code> is again a tuple, where each element corresponds to a wavefunction in the simulation. Each element in this tuple is an array with one extra dimension then the initial condition, which corresponds to the time dimension. We can use the <code>save_animation</code> function (which comes from StructuredLight and CairoMakie) to visualize the solution:</p><pre><code class="language-julia hljs">save_animation(abs2.(sol[1]), &quot;free_prop_example.mp4&quot;);</code></pre><p><video src="../free_prop_example.mp4" controls="true" title><a href="../free_prop_example.mp4"></a></video></p><h2 id="Gross-Pitaevskii-Equation"><a class="docs-heading-anchor" href="#Gross-Pitaevskii-Equation">Gross-Pitaevskii Equation</a><a id="Gross-Pitaevskii-Equation-1"></a><a class="docs-heading-anchor-permalink" href="#Gross-Pitaevskii-Equation" title="Permalink"></a></h2><p>We will now add a nonlinear term to the equation, which will make it a proper Gross-Pitaevskii equation: i ∂u(r, t)/∂t = -∇²u / 2 + g|u|²u where g is a coupling constant that defines the strength of the nonlinearity.</p><p>To add this nonlinear term, we need to define a new function that takes the wavefunction and returns the nonlinearity term (only the g|u|² part. Check <a href="../api/#GeneralizedGrossPitaevskii.GrossPitaevskiiProblem"><code>GrossPitaevskiiProblem</code></a> for more information).</p><pre><code class="language-julia hljs">nonlinearity(u, param) = param.g * abs2(u[1]);</code></pre><p>Here, we have used the <code>param</code> argument to pass the coupling constant <code>g</code>. We define this argument as a named tuple:</p><pre><code class="language-julia hljs">param = (; g=-6);</code></pre><p>The negative value of <code>g</code> indicates that we have a attractive nonlinearity, which will be clear in the visualization. Now we can create a new problem instance with the nonlinearity:</p><pre><code class="language-julia hljs">prob = GrossPitaevskiiProblem(u0, lengths; dispersion, nonlinearity, param);</code></pre><p>We used the same initial condition, lengths, and dispersion as before, but now we have added the nonlinearity and the parameters.</p><p>Just as before, we can solve the problem and visualize the solution:</p><pre><code class="language-julia hljs">tspan = (0, 0.4)
ts, sol = solve(prob, alg, tspan; nsaves, dt);

save_animation(abs2.(sol[1]), &quot;gross_pitaevskii.mp4&quot;);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr32">Progress:   3%|█▎                                       |  ETA: 0:00:16</span><span class="sgr32">Progress: 100%|█████████████████████████████████████████| Time: 0:00:00</span></code></pre><p>The attractive nonlinearity will cause the wavefunction to collapse into a localized structure, which can be seen in the animation.</p><p><video src="../gross_pitaevskii.mp4" controls="true" title><a href="../gross_pitaevskii.mp4"></a></video></p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../free_propagation_damping/">Damped Free Propagation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 22 September 2025 12:27">Monday 22 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
