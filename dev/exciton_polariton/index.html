<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Exciton Polariton · GeneralizedGrossPitaevskii.jl</title><meta name="title" content="Exciton Polariton · GeneralizedGrossPitaevskii.jl"/><meta property="og:title" content="Exciton Polariton · GeneralizedGrossPitaevskii.jl"/><meta property="twitter:title" content="Exciton Polariton · GeneralizedGrossPitaevskii.jl"/><meta name="description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><meta property="og:description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><meta property="twitter:description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GeneralizedGrossPitaevskii.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quick_start/">Quick-Start</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../free_propagation_damping/">Damped Free Propagation</a></li><li><a class="tocitem" href="../bistability/">Bistability</a></li><li class="is-active"><a class="tocitem" href>Exciton Polariton</a></li><li><a class="tocitem" href="../truncated_wigner/">Truncated Wigner method</a></li></ul></li><li><span class="tocitem">Technical Documentation</span><ul><li><a class="tocitem" href="../general_overview/">General Overview</a></li><li><a class="tocitem" href="../spatial_grid/">Spatial Grid</a></li><li><a class="tocitem" href="../multicomponent_systems/">Multicomponent Systems</a></li><li><a class="tocitem" href="../stochastic_simulations/">Stochastic Simulations</a></li><li><a class="tocitem" href="../algorithm_implementation/">Algorithm Implementation</a></li><li><a class="tocitem" href="../gpu/">GPU Support</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Exciton Polariton</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Exciton Polariton</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/marcsgil/GeneralizedGrossPitaevskii.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/marcsgil/GeneralizedGrossPitaevskii.jl/blob/main/examples/exciton_polariton.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Exciton-polariton-system"><a class="docs-heading-anchor" href="#Exciton-polariton-system">Exciton-polariton system</a><a id="Exciton-polariton-system-1"></a><a class="docs-heading-anchor-permalink" href="#Exciton-polariton-system" title="Permalink"></a></h1><p>In this example, we describe the polariton system as a two-component system consisting of excitons and photons inside a cavity. This will teach us how to model and simulate the dynamics of systems with two or more coupled components. The equations we want to solve are the following:</p><p class="math-container">\[i \frac{\partial}{\partial t} \begin{pmatrix} \psi_c \\ \psi_x \end{pmatrix} =
\begin{pmatrix} -\delta_c - i \gamma_c - \frac{\hbar^2 \nabla^2}{2m} &amp; \Omega_r \\
\Omega_r &amp; -\delta_x - i \gamma_x + g |\psi_x|^2 \end{pmatrix}
\begin{pmatrix} \psi_c \\ \psi_x \end{pmatrix}
+ \begin{pmatrix} F_c(x, t) \\ 0 \end{pmatrix}\]</p><p>In the above, <code>ψ_c</code> and <code>ψ_x</code> are the photonic and excitonic components of the polariton wavefunction, respectively, <code>δ_c</code> and <code>δ_x</code> are the detunings of the cavity and exciton modes, <code>γ_c</code> and <code>γ_x</code> are their decay rates, <code>m</code> is the effective mass of the photons in the cavity, <code>Ω_r</code> is the Rabi frequency describing the coupling between photons and excitons, <code>F_c(x, t)</code> is the coherent pump acting on the photonic component, and <code>g</code> is the strength of the exciton-exciton nonlinear interactions.</p><p>As always, we start by loading the package</p><pre><code class="language-julia hljs">using GeneralizedGrossPitaevskii</code></pre><p>As we are modeling a two component system, there are some differences with respect to the single component case. The main one is that, as the wavefunction now has two components, the terms in the equation (dispersion, nonlinearity, and pump) must be defined as arrays. This has to be done using the <a href="https://github.com/JuliaArrays/StaticArrays.jl">StaticArrays.jl</a> package, which allows us to define small fixed-size arrays efficiently, and, most importantly, allows us to use them in GPU kernels. For more information on why we use Static Arrays, see the <a href="../multicomponent_systems/#Multicomponent-Systems">Multicomponent Systems</a> section of the documentation.</p><p>The StaticArrays.jl package is reexported by GeneralizedGrossPitaevskii.jl, so we can use it directly. It&#39;s use is straightforward, usually only requiring the inclusion of the <code>@SVector</code> or <code>@SMatrix</code> macro in front of the array definition.</p><p>With that in mind, here is the dispersion term:</p><pre><code class="language-julia hljs">function dispersion(k, param)
    Dcc = param.ħ * sum(abs2, k) / 2param.m - param.δc - im * param.γc
    Dxx = -param.δx - im * param.γx
    Dxc = param.Ωr
    @SMatrix [Dcc Dxc; Dxc Dxx]
end;</code></pre><p>We include the detuning and decay terms in the dispersion, as they are constants, as well as the coupling term <code>Ω_r</code> and the Laplacian in Fourier space.</p><p>In general, the nonlinear term is also a matrix, but in this case, it is diagonal. Therefore, it is sufficient and more efficient to define only the diagonal elements as a vector.</p><pre><code class="language-julia hljs">nonlinearity(ψ, param) = @SVector [0, param.g * abs2(ψ[2])];</code></pre><p>Finally, we define the pump profile, which is only applied to the photonic component. We choose a Gaussian profile in space, but any other profile could be used.</p><pre><code class="language-julia hljs">function pump(r, param, t)
    cpump = param.A * exp(-sum(abs2, r .- param.L / 2) / param.w^2)
    xpump = zero(cpump)
    @SVector [cpump, xpump]
end;</code></pre><p>Now, we define the parameters of the system and collect them in a named tuple. Notice that, to specify a system with two spatial dimensions, we only need to make the lengths tuple have two elements, one for each dimension, and the initial condition must be a tuple of two 2D arrays, one for each component. The initial condition we choose here corresponds to an empty cavity.</p><pre><code class="language-julia hljs">ħ = 0.654 # (meV*ps)
Ωr = 4
γx = 0.02
γc = 0.16
m = 1

δx = -2.56
δc = 0

A = 2
w = 100

g = 0.015

L = 256
N = 128
lengths = (L, L)

param = (; ħ, m, δc, γc, δx, γx, Ωr, A, w, g, L)
u0 = (zeros(ComplexF64, N, N), zeros(ComplexF64, N, N));</code></pre><p>Now, we define the problem, the number of saves, the time step, the time span, and the algorithm to use. We then are ready to solve it.</p><pre><code class="language-julia hljs">prob = GrossPitaevskiiProblem(u0, lengths; dispersion, nonlinearity, pump, param)
nsaves = 64
dt = 5e-2
tspan = (0, 100)
alg = StrangSplitting()
ts, sol = solve(prob, alg, tspan; nsaves, dt, show_progress=false);</code></pre><p>The solution <code>sol</code> is a tuple of two arrays, one for each component. Each array has dimensions <code>(N, N, nsaves)</code>, where the first two dimensions correspond to space and the last one to time.</p><p>To test our implementation, we can check that the steady-state solution obtained from the simulation matches the one obtained from the analytical expression. For a homogeneous pump, the steady-state solution can be shown to obey the following relations:</p><p class="math-container">\[\left| \frac{(\delta_x + i \gamma_x - g n_x)(\delta_c + i \gamma_c)}{\Omega_r} - \Omega_r \right|^2 n_x = |F_c|^2 \\
\frac{|\delta_x + i \gamma_x - g n_x|^2}{\Omega_r^2}n_x = n_c\]</p><p>Although our pump is not homogeneous, it is approximately so in the center of the system, where the pump amplitude is close to <code>A</code>. Therefore, we can check the above relations using the densities at the center of the system at the final time.</p><pre><code class="language-julia hljs">nx = abs2.(last(sol))[N÷2, N÷2, end]
nc = abs2.(first(sol))[N÷2, N÷2, end];</code></pre><p>We can check that the relations are satisfied approximately.</p><p>This is the first relation:</p><pre><code class="language-julia hljs">abs2(Ωr - (δx + im * γx - g * nx) * (δc + im * γc) / Ωr) * nx / abs2(A) # ≈ 1</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.9922532684795705</code></pre><p>This is the second relation:</p><pre><code class="language-julia hljs">abs2(δx + im * γx - g * nx) * nx / Ωr^2 / nc # ≈ 1</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.9939256000275484</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bistability/">« Bistability</a><a class="docs-footer-nextpage" href="../truncated_wigner/">Truncated Wigner method »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 22 September 2025 12:27">Monday 22 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
