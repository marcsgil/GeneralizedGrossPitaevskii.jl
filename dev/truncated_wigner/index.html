<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Truncated Wigner method · GeneralizedGrossPitaevskii.jl</title><meta name="title" content="Truncated Wigner method · GeneralizedGrossPitaevskii.jl"/><meta property="og:title" content="Truncated Wigner method · GeneralizedGrossPitaevskii.jl"/><meta property="twitter:title" content="Truncated Wigner method · GeneralizedGrossPitaevskii.jl"/><meta name="description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><meta property="og:description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><meta property="twitter:description" content="Documentation for GeneralizedGrossPitaevskii.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">GeneralizedGrossPitaevskii.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../quick_start/">Quick-Start</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../free_propagation_damping/">Damped Free Propagation</a></li><li><a class="tocitem" href="../bistability/">Bistability</a></li><li><a class="tocitem" href="../exciton_polariton/">Exciton Polariton</a></li><li class="is-active"><a class="tocitem" href>Truncated Wigner method</a><ul class="internal"><li><a class="tocitem" href="#Theoretical-Background"><span>Theoretical Background</span></a></li><li><a class="tocitem" href="#Simulation-of-the-steady-state"><span>Simulation of the steady state</span></a></li><li><a class="tocitem" href="#Inclusion-of-quantum-noise"><span>Inclusion of quantum noise</span></a></li><li><a class="tocitem" href="#Extraction-of-quantum-statistical-properties"><span>Extraction of quantum statistical properties</span></a></li></ul></li></ul></li><li><span class="tocitem">Technical Documentation</span><ul><li><a class="tocitem" href="../general_overview/">General Overview</a></li><li><a class="tocitem" href="../spatial_grid/">Spatial Grid</a></li><li><a class="tocitem" href="../multicomponent_systems/">Multicomponent Systems</a></li><li><a class="tocitem" href="../stochastic_simulations/">Stochastic Simulations</a></li><li><a class="tocitem" href="../algorithm_implementation/">Algorithm Implementation</a></li><li><a class="tocitem" href="../gpu/">GPU Support</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Truncated Wigner method</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Truncated Wigner method</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/marcsgil/GeneralizedGrossPitaevskii.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/marcsgil/GeneralizedGrossPitaevskii.jl/blob/main/examples/truncated_wigner.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Truncated-Wigner-method"><a class="docs-heading-anchor" href="#Truncated-Wigner-method">Truncated Wigner method</a><a id="Truncated-Wigner-method-1"></a><a class="docs-heading-anchor-permalink" href="#Truncated-Wigner-method" title="Permalink"></a></h1><p>In this example, we simulate the quantum properties of a coherently driven polariton fluid using the truncated Wigner method. In particular, we will compute the steady-state momentum distribution and the second-order correlation function in momentum space, g₂(k, k&#39;). This will teach us how to include noise terms in our simulations, and how to extract quantum statistical properties from the results. We will see the appearance of strong correlations between modes with opposite momenta, which are a signature of pair production processes in the fluid.</p><h2 id="Theoretical-Background"><a class="docs-heading-anchor" href="#Theoretical-Background">Theoretical Background</a><a id="Theoretical-Background-1"></a><a class="docs-heading-anchor-permalink" href="#Theoretical-Background" title="Permalink"></a></h2><p>The truncated Wigner method is a powerful technique for simulating the quantum dynamics of many-body systems. It approximates the quantum field by a classical stochastic field with appropriate initial conditions and noise terms. The stochastic differential equation we solve in this method takes the form:</p><p class="math-container">\[i d\psi = \left( -\delta - i \frac{\gamma}{2} - \frac{\hbar \nabla^2}{2m} + g (|\psi|^2 - \frac{1}{\text{dx}}) \right)\psi dt + F dt + \sqrt{\frac{\gamma}{2\text{dx}}} dW(x,t)\]</p><p>Here, ψ is the polariton field, δ is the detuning, γ is the decay rate, m is the effective mass, g is the nonlinearity strength, F is the coherent pump, and dW(x,t) is a complex Wiener process.</p><p>For more details on the derivation and validity of the truncated Wigner method, see [<a href="../references/#RevModPhys_85_299">1</a>, <a href="../references/#PhysRevB_72_125335">2</a>].</p><h2 id="Simulation-of-the-steady-state"><a class="docs-heading-anchor" href="#Simulation-of-the-steady-state">Simulation of the steady state</a><a id="Simulation-of-the-steady-state-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-of-the-steady-state" title="Permalink"></a></h2><p>First, let&#39;s simulate the system without noise to establish the steady-state solution. This will serve as our reference point for understanding the quantum effects that appear when we add noise.</p><pre><code class="language-julia hljs">using GeneralizedGrossPitaevskii, FFTW, CairoMakie, Statistics</code></pre><p>We define the equation components according to our stochastic differential equation above. The dispersion relation includes the kinetic energy, detuning, and decay terms:</p><pre><code class="language-julia hljs">function dispersion(ks, param)
    param.ħ * sum(abs2, ks) / 2param.m - param.δ - im * param.γ / 2
end;</code></pre><p>The pump is spatially uniform and constant in time:</p><pre><code class="language-julia hljs">function pump(x, param, t)
    param.A
end;</code></pre><p>The nonlinearity includes a -1/dx regularization term:</p><pre><code class="language-julia hljs">nonlinearity(ψ, param) = param.g * (abs2(first(ψ)) - 1 / param.dx);</code></pre><p>Now we define the physical parameters for a typical polariton system:</p><pre><code class="language-julia hljs">ħ = 0.6582
γ = 0.047 / ħ
m = 1 / 6
g = 3e-4 / ħ
δ = 0.49 / ħ
A = 10;</code></pre><p>Grid and parameters for a 1D system:</p><pre><code class="language-julia hljs">L = 512
N = 256
dx = L / N

lengths = (L,)
param = (; ħ, m, δ, γ, g, A, L, dx)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ħ = 0.6582, m = 0.16666666666666666, δ = 0.7444545730780917, γ = 0.07140686721361288, g = 0.0004557885141294439, A = 10, L = 512, dx = 2.0)</code></pre><p>We initialize the field to zero and solve the mean-field Gross-Pitaevskii equation without noise:</p><pre><code class="language-julia hljs">u0 = (zeros(ComplexF64, N),);
prob = GrossPitaevskiiProblem(u0, lengths; dispersion, nonlinearity, pump, param)
nsaves = 512
dt = 0.05
tspan = (0, 200)
alg = StrangSplitting()
ts, sol = solve(prob, alg, tspan; nsaves, dt, show_progress=false);</code></pre><p>Let&#39;s examine how the density at one spatial point evolves toward steady state:</p><pre><code class="language-julia hljs">ns = abs2.(sol[1][1, :])

with_theme(theme_latexfonts()) do
    fig = Figure()
    ax = Axis(fig[1, 1]; xlabel=&quot;t&quot;, ylabel=&quot;n&quot;)
    lines!(ax, ts, ns; linewidth=2)
    fig
end</code></pre><img src="214f3775.png" alt="Example block output"/><p>We can see the density approaches a steady-state value, confirming that our system reaches equilibrium.</p><h2 id="Inclusion-of-quantum-noise"><a class="docs-heading-anchor" href="#Inclusion-of-quantum-noise">Inclusion of quantum noise</a><a id="Inclusion-of-quantum-noise-1"></a><a class="docs-heading-anchor-permalink" href="#Inclusion-of-quantum-noise" title="Permalink"></a></h2><p>Now we implement the full truncated Wigner method by including quantum noise. In this approach, we run many stochastic trajectories with random initial conditions and noise terms. Each trajectory represents one possible realization of the field evolution.</p><p>We initialize with random Gaussian noise in the field amplitudes, as required by the Wigner representation of the vacuum state. We also define a second dimension that represents the ensemble of stochastic trajectories.</p><pre><code class="language-julia hljs">u0 = (randn(ComplexF64, N, 256) / √(2dx),);</code></pre><p>The noise prototype specifies the shape and type of the noise to be added at each time step. In this case, it matches the shape and type of the initial condition.</p><pre><code class="language-julia hljs">noise_prototype = similar.(u0);</code></pre><p>The position noise function corresponds to the √(γ/2dx) dW(x,t) term in our stochastic equation:</p><pre><code class="language-julia hljs">position_noise_func(ψ, xs, param) = √(param.γ / (2param.dx));</code></pre><p>Now we solve the problem with noise included:</p><pre><code class="language-julia hljs">prob = GrossPitaevskiiProblem(u0, lengths; dispersion, nonlinearity, pump, param, noise_prototype, position_noise_func)
ts, sol = solve(prob, alg, tspan; nsaves=1, dt, save_start=false, show_progress=false);</code></pre><h2 id="Extraction-of-quantum-statistical-properties"><a class="docs-heading-anchor" href="#Extraction-of-quantum-statistical-properties">Extraction of quantum statistical properties</a><a id="Extraction-of-quantum-statistical-properties-1"></a><a class="docs-heading-anchor-permalink" href="#Extraction-of-quantum-statistical-properties" title="Permalink"></a></h2><p>From the ensemble of stochastic trajectories, we can extract quantum statistical properties that are not accessible in classical mean-field simulations.</p><h3 id="Occupation-number-in-momentum-space"><a class="docs-heading-anchor" href="#Occupation-number-in-momentum-space">Occupation number in momentum space</a><a id="Occupation-number-in-momentum-space-1"></a><a class="docs-heading-anchor-permalink" href="#Occupation-number-in-momentum-space" title="Permalink"></a></h3><p>First, we transform to momentum space and calculate the average occupation number:</p><pre><code class="language-julia hljs">ft_sol = fftshift(fft(sol[1], 1), 1) / N
ks = fftshift(fftfreq(N, 2π / dx));</code></pre><p>The momentum distribution n(k) is obtained by averaging |ψ(k)|² over all trajectories, with a correction term of -1/(2L) to account for the Wigner representation:</p><pre><code class="language-julia hljs">nks = dropdims(mean(abs2, ft_sol; dims=2), dims=(2, 3)) .- 1 / (2L)

with_theme(theme_latexfonts()) do
    fig = Figure(; fontsize=16)
    ax2 = Axis(fig[1, 1]; xlabel=&quot;k&quot;, ylabel=&quot;n(k)&quot;)
    ylims!(ax2, 0, 0.0025)
    lines!(ax2, ks, nks, linewidth=2)
    fig
end</code></pre><img src="c044326e.png" alt="Example block output"/><p>The momentum distribution shows a symmetric peak at k=0 and tails extending to finite momentum. The result is noisy, but this is solved by simply increasing the number of stochastic trajectories.</p><h3 id="Second-order-correlation-function-in-momentum-space"><a class="docs-heading-anchor" href="#Second-order-correlation-function-in-momentum-space">Second-order correlation function in momentum space</a><a id="Second-order-correlation-function-in-momentum-space-1"></a><a class="docs-heading-anchor-permalink" href="#Second-order-correlation-function-in-momentum-space" title="Permalink"></a></h3><p>Now we calculate the second-order correlation function g₂(k,k&#39;), which reveals quantum correlations between different momentum modes. This quantity is defined as:</p><p class="math-container">\[g_2(k, k&#39;) = \frac{\langle \hat{\psi}_1^*(k) \hat{\psi}_2^*(k&#39;) \hat{\psi}_1(k) \hat{\psi}_2(k&#39;) \rangle}{n(k) n(k&#39;)}\]</p><p>where <span>$\hat{\psi}$</span> denotes quantum field operators.</p><p>In the Wigner representation, we must include corrections to account for the symmetrically ordered nature of the representation. Therefore, the calculation of g₂(k,k&#39;) from the stochastic fields requires the formula:</p><p class="math-container">\[\langle \hat{\psi}^{\dagger}(k) \hat{\psi}^{\dagger}(k&#39;) \hat{\psi}(k&#39;) \hat{\psi}(k) \rangle
= \left\langle |\psi(k)|^2 |\psi(k&#39;)|^2 - \frac{1}{2L}(1 + \delta_{k,k&#39;})
\cdot \left( |\psi(k)|^2 + |\psi(k&#39;)|^2 - \frac{1}{2L} \right) \right\rangle_W\]</p><p>where ⟨...⟩_W denotes averaging over the stochastic trajectories in the Wigner representation.</p><p>We define now some helper functions to compute this quantity correctly:</p><pre><code class="language-julia hljs">function f(x, y, δ, commutator)
    abs2(x) * abs2(y) - (1 + δ) * commutator / 2 * (abs2(x) + abs2(y) - commutator / 2)
end

function G2(sol, commutator)
    result = similar(sol, real(eltype(sol)), (size(sol, 1), size(sol, 1)))

    for n ∈ axes(result, 2), m in axes(result, 1)
        result[m, n] = mapreduce((x, y) -&gt; f(x, y, m == n, commutator), +,
            view(sol, m, :), view(sol, n, :)) / size(sol, 2)
    end

    result
end;</code></pre><p>Now we calculate the correlation function:</p><pre><code class="language-julia hljs">G2k = G2(ft_sol, 1 / L)
g2k = G2k ./ (nks * nks&#39;);</code></pre><p>Visualize the correlation function:</p><pre><code class="language-julia hljs">with_theme(theme_latexfonts()) do
    fig = Figure(; fontsize=16, size=(500, 400))
    ax = Axis(fig[1, 1]; xlabel=L&quot;k&quot;, ylabel=L&quot;k&#39;&quot;, aspect=DataAspect())
    xlims!(ax, -0.6, 0.6)
    ylims!(ax, -0.6, 0.6)
    hm = heatmap!(ax, ks, ks, g2k, colorrange=(0, 3))
    Colorbar(fig[1, 2], hm, label=L&quot;g_2(k, k&#39;)&quot;)
    fig
end</code></pre><img src="6f1b6cf9.png" alt="Example block output"/><p>The correlation function reveals strong correlations along the anti-diagonal (k ≈ -k&#39;), which is a signature of spontaneous pair production processes in the driven-dissipative fluid. This quantum effect cannot be captured by classical mean-field theories and demonstrates the power of the truncated Wigner method for studying quantum many-body phenomena.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../exciton_polariton/">« Exciton Polariton</a><a class="docs-footer-nextpage" href="../general_overview/">General Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 30 September 2025 13:26">Tuesday 30 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
